INTSourceChangelist:3810557
Availability:Public
Title:ランドスケープ スプライン
Crumbs: %ROOT%, Engine, Engine/Landscape, Engine/Landscape/Editing
Description:ランドスケープの彫刻、ブレンドマスクの修正、メッシュを道路に変形するためのスプライン
version:4.9

[VAR:Topic]
[OBJECT:Topiccompact]
	[PARAM:image]
		![%Engine/Landscape/Editing/Splines:title%](Engine/Landscape/Editing/Splines/landscape_spline_topic.png)
	[/PARAM]
	[PARAM:icon]
		![Landscape Icon](%ROOT%/landscape_icon.png)(convert:false)
	[/PARAM]
	[PARAM:title]
		%Engine/Landscape/Editing/Splines:title%
	[/PARAM]
	[PARAM:description]
		%Engine/Landscape/Editing/Splines:description%
	[/PARAM]
	[PARAM:path]
		[RELATIVE:Engine/Landscape/Editing/Splines]
	[/PARAM]
[/OBJECT]
[/VAR]

[TOC(start:2)]

**Spline** ツールとは、山脈のテレインに平らな道路を作成するなど、テレイン メッシュを一緒に変形させるスプライン アクタを作成するツールです。

[EXCERPT:Splines001]

[INCLUDE:#LandscapeSplines]

このツールは、環境に道路や小道を作成するために使われます。一般的に、敷石道や長くまっすぐなトウモロコシの列など、テレインに同調させる必要のあるメッシュに対して使用することも可能です。 

[/EXCERPT:Splines001]

[COMMENT:none]
[EXCERPT:LandscapeSplines]
**ランドスケープ スプライン** は、ランドスケープに同調させる必要のある線形の地物を作成し、テレインを操作してこれらの地物を構築しやすく出来る順応性のあるシステムです。作成にはランドスケープ エディタのスプライン ツールを使用します。
[/EXCERPT:LandscapeSplines]
[/COMMENT]

## スプラインの作成

**スプラインの作成方法**

1. **Manage** モードから **Edit Splines** ツールを選びます。

	![Spline Tool](Landscape_SplineTool.png)

1. 選択中のランドスケープ上で **Ctrl + 左クリック** でスプラインの最初の制御点を設定します。制御点のスプライトは、でこぼこした茶色と白の大きな岩のように見えます。

	![A Spline control point](control_point.jpg)(w:785 type:jpg)

1. 再度 **Ctrl + 左クリック** で、別の制御点が作成され、スプライン セグメントで最初の点と結合します。選択すれば新規の制御点を変更することができます。この操作を繰り返して制御点を追加することができます。

	![A second spline control point](short_spline.jpg)(w:785 type:jpg)


**2 つのスプラインを結合する方法**

* スプラインを 1 つ選び、もう一方のスプライン上で **Ctrl + 左クリック** します。


**スプラインを分割する方法**

* セグメント上で **Ctrl + 左クリック** します。これによりセグメントが分割され、新規の制御点が挿入されます。

Static Mesh アクタをスプラインのセグメントに沿うように割り当てることができます。

**Static Mesh アクタをスプラインに追加する**

1. **コンテンツブラウザ** からスプラインと使用した Static Mesh アセットを選択します。

1. ランドスケープ上でスプラインの制御点をクリックします。

1. レベルエディタの **[Details (詳細)]** パネルの **[Landscape Spline]** セクションの **[Select all connected (接続されている全てを選択)]** の隣にある **Segments** をクリックします。これにより、スタティックメッシュが全てのスプラインのセグメントに確実に追加されます。

	![All Segments](Landscape_SplineAllSegments.png)

1. **[Landscape Spline Meshes]** セクションの **Spline Meshes** の中にエレメントがない場合、プラスアイコン (![Plus Icon](Engine/Landscape/Materials/icon_Landscape_PlusSign.png)) をクリックして追加します。

	![Add Mesh](Landscape_SplineMeshAdd.png)

1. 追加したエレメントを展開します。**Mesh** の隣の矢印アイコン (![Assign](Shared/Icons/icon_assign_left_16x.png)) をクリックして選択したスタティックメッシュを割り当てます。

	![Mesh Added](Landscape_SplineMeshAdded.png)

[REGION:tip]
必要に応じて、個々の制御点にスタティックメッシュを割り当てることもできます。その場合は、制御点を選んで **[Mesh]** セクションの **[Details (詳細)]** パネルにスタティックメッシュを割り当てます。
[/REGION]


## スプラインを編集する


スプラインの制御点は、動作や回転ツールとして期待通りの反応をしますが、スケール ツールは別の UI を開きます。

![Segment tangent scale tool](segment_scale.jpg)(w:785 type:jpg)

これらはスプライン タンジェントです。セグメントが選択されると、セグメントの両端にタンジェントが表示されます。制御点が選択されると、接続しているセグメント全てのタンジェントが表示されます。
タンジェントの端をドラッグしてタンジェントのスケーリングを調整出来ます。この作業でスプラインのセグメントの曲線を修正します。


## スプラインをランドスケープに適用する

**[Apply Splines to Landscape (スプラインをランドマークに適用)]** ボタンは、スプライン情報を使用してランドスケープの高さマップと重みマップを修正します。
高さマップは、いずれかの側で滑らかにコサインブレンド フォールオフをして、スプラインに合わせて上げ下げします。高さマップは、スプライン制御点の Width と Falloff プロパティ、および個々のスプライン セグメント上の **[Raise/Lower Terrain (テレインを上げる / 下げる)]** オプションで制御されます。
ペイントされたテクスチャ レイヤは個々のスプライン セグメントの **Layer Name** プロパティに指定されます。ペイントは制御点のスプライン幅およびスプライン フォールオフ設定に影響されます。


## Spline プロパティ

選択した制御点もしくはセグメントは、レベル エディタの **[Details (詳細)]** パネルに表示されます。

### 制御点のプロパティ

| プロパティ | 説明 |
| ------------- | ------------ |
| **Location**      | アタッチしているランドスケープに相対的な制御点の位置です。
| **Rotation**      | 制御点の回転。この時点でアタッチしているスプライン セグメントのタンジェント方向をコントロールします。
| **Width**         | この時点のスプラインの幅。実線で示されます。接続している全てのセグメントに影響します。
| **Side Falloff**  | この時点のスプライン両側のコサインブレンドされたフォールオフ領域の幅。点線で示されます。
| **End Falloff**   | スプラインの終端のみに関係します (アタッチされたセグメントが一つの制御点)。スプライン セグメントが滑らかに終了するコサインがブレンドされたフォールオフ領域の長さです。
| **Layer Name**    | スプラインがランドスケープに適用される時にペイントされるブレンドマスク レイヤ名です。
| **Raise Terrain** | ランドスケープにスプラインの適用時、スプラインに合致するようにランドスケープを高くします。土手に描くロード作成に実用的です。
| **Lower Terrain** | スプラインがランドスケープに適用されると、スプラインに合致するようにランドスケープを下げます。川や溝などに実用的です。

### スプライン セグメントのプロパティ

[COMMENT:none]


以下はプロパティ テーブルのサブテーブルです。

[EXCERPT:SplineSegProp001]
| ---- | ---- |
| **接続のサブプロパティ** ||
| Tangent Len | この時点のタンジェントのスケーリングで、セグメントのカーブ具合をコントロールします。負のタンジェントは、セグメントを制御点の後ろへ結合させます。 |
| Socket Name | このセグメントの終端が接続される制御点のソケットです。 |
[/EXCERPT:SplineSegProp001]

[EXCERPT:SplineSegProp002]
| ---- | ---- |
|  **スプライン メッシュのサブプロパティ (用途別)**  ||
| Mesh           | 使用するスタティックメッシュ|
| Material Overrides | スタティックメッシュが割り当てたマテリアルを異なるスプラインのマテリアルでオーバーライドします。 |
| Center H       | スプラインでメッシュを平行に中央揃えにするか、またはメッシュの原点を使用するか決定します。 |
| Offset         | スプラインからメッシュをオフセットします (単位はメッシュ空間に、スプラインによってアンスケール)。 |
| Scale to Width | メッシュがスプライン幅にフィットするようスケーリングするか、そのままのメッシュを使用するかを決定します。 |
| Scale          | メッシュサイズの乗数です。**Scale to Width** が有効化されると、ここで指定された **Scale** がスプライン幅に相対的となります。もしくは、メッシュの実際のサイズに相対的となります。 |
| Forward Axis   | **Spline Mesh** の前方軸を選択します。 |
| Up Axis        | **Spline Mesh** の情報軸を選択します。 |
[/EXCERPT:SplineSegProp002]


[/COMMENT]

| プロパティ | 説明 |
| ------------- | ------------ |
| [REGION:tablesection]ランドスケープ スプライン セグメント[/REGION] ||
| **Connections**   | セグメントがアタッチしている 2 つの制御点に特有の設定です。
| ^ | [INCLUDE:#SplineSegProp001] |
| **Layer Name**    | スプラインがランドスケープに適用される時にペイントされるブレンドマスク レイヤ名です。
| **Raise Terrain** | ランドスケープにスプラインの適用時、スプラインに合致するようにランドスケープを高くします。土手に描くロード作成に実用的です。
| **Lower Terrain** | スプラインがランドスケープに適用されると、スプラインに合致するようにランドスケープを下げます。川や溝などに実用的です。
| [REGION:tablesection]ランドスケープ スプライン メッシュ[/REGION] ||
| **Spline Meshes**    | スプラインに適用するメッシュです。ランダムシードによってランダムな順番で複数のメッシュを適用します。
| ^ | [INCLUDE:#SplineSegProp002] |
|**Random Seed**      |複数のスプライン メッシュがスプラインに適用される順番をコントロールします。  |
| **Enable Collision** | スプライン メッシュのコリジョンを有効化します。 |
| **Cast Shadow** | メッシュによるシャドウ キャストを可能にします。 |


## 制御基準

| 操作 | 処理内容 |
| --------------------------- | ------------  |
| **Left Mouse Button**         | 制御点またはセグメントを選択します。
| **Shift + Left Mouse Button** | 複数の制御点またはセグメントを選択します。
| **Ctrl + A**                  | 現在選択されている制御点に結合した全ての制御点、または現在選択されているセグメントに結合した全てのセグメントを選択します。
| **Ctrl + Left Mouse Button**  | ランドスケープ上で、新規の制御点を追加し、選択した制御点と結合します。
| **^**                           | 制御点または選択された制御点を使って、新規制御点に対して選択された全ての制御点セグメントと結合するセグメントを作成します。
| **^**                           | セグメント上で、セグメントをその時点で分割させ、新規の制御点を挿入します。
| **Del**                       | 選択した制御点またはセグメントを削除します。
| **R**                         | 選択したスプラインの制御点の回転を自動的に演算します。
| **T**                         | 選択した制御点/セグメントのタンジェントを自動的にフリップします。
| **F**                         | 選択したスプライン セグメントをフリップします (スプラインにあるメッシュのみに影響)。
| **End**                       | 選択した制御点を下方のランドスケープへスナップします。

[INCLUDE:Engine/Landscape#landscape002]
